{"ast":null,"code":"import { IdbKeyVal } from './db';\nexport const KEY_STORAGE_KEY = 'identity';\nexport const KEY_STORAGE_DELEGATION = 'delegation';\nexport const KEY_VECTOR = 'iv';\n// Increment if any fields are modified\nexport const DB_VERSION = 1;\nexport const isBrowser = typeof window !== 'undefined';\n/**\n * Legacy implementation of AuthClientStorage, for use where IndexedDb is not available\n */\nexport class LocalStorage {\n  constructor(prefix = 'ic-', _localStorage) {\n    this.prefix = prefix;\n    this._localStorage = _localStorage;\n  }\n  get(key) {\n    return Promise.resolve(this._getLocalStorage().getItem(this.prefix + key));\n  }\n  set(key, value) {\n    this._getLocalStorage().setItem(this.prefix + key, value);\n    return Promise.resolve();\n  }\n  remove(key) {\n    this._getLocalStorage().removeItem(this.prefix + key);\n    return Promise.resolve();\n  }\n  _getLocalStorage() {\n    if (this._localStorage) {\n      return this._localStorage;\n    }\n    const ls = typeof window === 'undefined' ? typeof global === 'undefined' ? typeof self === 'undefined' ? undefined : self.localStorage : global.localStorage : window.localStorage;\n    if (!ls) {\n      throw new Error('Could not find local storage.');\n    }\n    return ls;\n  }\n}\n/**\n * IdbStorage is an interface for simple storage of string key-value pairs built on {@link IdbKeyVal}\n *\n * It replaces {@link LocalStorage}\n * @see implements {@link AuthClientStorage}\n */\nexport class IdbStorage {\n  get _db() {\n    return new Promise(resolve => {\n      if (this.initializedDb) {\n        resolve(this.initializedDb);\n        return;\n      }\n      IdbKeyVal.create({\n        version: DB_VERSION\n      }).then(db => {\n        this.initializedDb = db;\n        resolve(db);\n      });\n    });\n  }\n  async get(key) {\n    const db = await this._db;\n    return await db.get(key);\n    // return (await db.get<string>(key)) ?? null;\n  }\n  async set(key, value) {\n    const db = await this._db;\n    await db.set(key, value);\n  }\n  async remove(key) {\n    const db = await this._db;\n    await db.remove(key);\n  }\n}","map":{"version":3,"names":["IdbKeyVal","KEY_STORAGE_KEY","KEY_STORAGE_DELEGATION","KEY_VECTOR","DB_VERSION","isBrowser","window","LocalStorage","constructor","prefix","_localStorage","get","key","Promise","resolve","_getLocalStorage","getItem","set","value","setItem","remove","removeItem","ls","global","self","undefined","localStorage","Error","IdbStorage","_db","initializedDb","create","version","then","db"],"sources":["C:\\Users\\pc\\Desktop\\aletheia-dapp\\aletheia-dapp\\canisters\\frontend\\user_interface\\node_modules\\@dfinity\\auth-client\\src\\storage.ts"],"sourcesContent":["import { IdbKeyVal } from './db';\n\nexport const KEY_STORAGE_KEY = 'identity';\nexport const KEY_STORAGE_DELEGATION = 'delegation';\nexport const KEY_VECTOR = 'iv';\n// Increment if any fields are modified\nexport const DB_VERSION = 1;\n\nexport const isBrowser = typeof window !== 'undefined';\n\nexport type StoredKey = string | CryptoKeyPair;\n\n/**\n * Interface for persisting user authentication data\n */\nexport interface AuthClientStorage {\n  get(key: string): Promise<StoredKey | null>;\n\n  set(key: string, value: StoredKey): Promise<void>;\n\n  remove(key: string): Promise<void>;\n}\n\n/**\n * Legacy implementation of AuthClientStorage, for use where IndexedDb is not available\n */\nexport class LocalStorage implements AuthClientStorage {\n  constructor(public readonly prefix = 'ic-', private readonly _localStorage?: Storage) {}\n\n  public get(key: string): Promise<string | null> {\n    return Promise.resolve(this._getLocalStorage().getItem(this.prefix + key));\n  }\n\n  public set(key: string, value: string): Promise<void> {\n    this._getLocalStorage().setItem(this.prefix + key, value);\n    return Promise.resolve();\n  }\n\n  public remove(key: string): Promise<void> {\n    this._getLocalStorage().removeItem(this.prefix + key);\n    return Promise.resolve();\n  }\n\n  private _getLocalStorage() {\n    if (this._localStorage) {\n      return this._localStorage;\n    }\n\n    const ls =\n      typeof window === 'undefined'\n        ? typeof global === 'undefined'\n          ? typeof self === 'undefined'\n            ? undefined\n            : self.localStorage\n          : global.localStorage\n        : window.localStorage;\n\n    if (!ls) {\n      throw new Error('Could not find local storage.');\n    }\n\n    return ls;\n  }\n}\n\n/**\n * IdbStorage is an interface for simple storage of string key-value pairs built on {@link IdbKeyVal}\n *\n * It replaces {@link LocalStorage}\n * @see implements {@link AuthClientStorage}\n */\nexport class IdbStorage implements AuthClientStorage {\n  // Initializes a KeyVal on first request\n  private initializedDb: IdbKeyVal | undefined;\n  get _db(): Promise<IdbKeyVal> {\n    return new Promise(resolve => {\n      if (this.initializedDb) {\n        resolve(this.initializedDb);\n        return;\n      }\n      IdbKeyVal.create({ version: DB_VERSION }).then(db => {\n        this.initializedDb = db;\n        resolve(db);\n      });\n    });\n  }\n\n  public async get(key: string): Promise<string | null> {\n    const db = await this._db;\n    return await db.get<string>(key);\n    // return (await db.get<string>(key)) ?? null;\n  }\n\n  public async set(key: string, value: string): Promise<void> {\n    const db = await this._db;\n    await db.set(key, value);\n  }\n\n  public async remove(key: string): Promise<void> {\n    const db = await this._db;\n    await db.remove(key);\n  }\n}\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,MAAM;AAEhC,OAAO,MAAMC,eAAe,GAAG,UAAU;AACzC,OAAO,MAAMC,sBAAsB,GAAG,YAAY;AAClD,OAAO,MAAMC,UAAU,GAAG,IAAI;AAC9B;AACA,OAAO,MAAMC,UAAU,GAAG,CAAC;AAE3B,OAAO,MAAMC,SAAS,GAAG,OAAOC,MAAM,KAAK,WAAW;AAetD;;;AAGA,OAAM,MAAOC,YAAY;EACvBC,YAA4BC,MAAA,GAAS,KAAK,EAAmBC,aAAuB;IAAxD,KAAAD,MAAM,GAANA,MAAM;IAA2B,KAAAC,aAAa,GAAbA,aAAa;EAAa;EAEhFC,GAAGA,CAACC,GAAW;IACpB,OAAOC,OAAO,CAACC,OAAO,CAAC,IAAI,CAACC,gBAAgB,EAAE,CAACC,OAAO,CAAC,IAAI,CAACP,MAAM,GAAGG,GAAG,CAAC,CAAC;EAC5E;EAEOK,GAAGA,CAACL,GAAW,EAAEM,KAAa;IACnC,IAAI,CAACH,gBAAgB,EAAE,CAACI,OAAO,CAAC,IAAI,CAACV,MAAM,GAAGG,GAAG,EAAEM,KAAK,CAAC;IACzD,OAAOL,OAAO,CAACC,OAAO,EAAE;EAC1B;EAEOM,MAAMA,CAACR,GAAW;IACvB,IAAI,CAACG,gBAAgB,EAAE,CAACM,UAAU,CAAC,IAAI,CAACZ,MAAM,GAAGG,GAAG,CAAC;IACrD,OAAOC,OAAO,CAACC,OAAO,EAAE;EAC1B;EAEQC,gBAAgBA,CAAA;IACtB,IAAI,IAAI,CAACL,aAAa,EAAE;MACtB,OAAO,IAAI,CAACA,aAAa;;IAG3B,MAAMY,EAAE,GACN,OAAOhB,MAAM,KAAK,WAAW,GACzB,OAAOiB,MAAM,KAAK,WAAW,GAC3B,OAAOC,IAAI,KAAK,WAAW,GACzBC,SAAS,GACTD,IAAI,CAACE,YAAY,GACnBH,MAAM,CAACG,YAAY,GACrBpB,MAAM,CAACoB,YAAY;IAEzB,IAAI,CAACJ,EAAE,EAAE;MACP,MAAM,IAAIK,KAAK,CAAC,+BAA+B,CAAC;;IAGlD,OAAOL,EAAE;EACX;;AAGF;;;;;;AAMA,OAAM,MAAOM,UAAU;EAGrB,IAAIC,GAAGA,CAAA;IACL,OAAO,IAAIhB,OAAO,CAACC,OAAO,IAAG;MAC3B,IAAI,IAAI,CAACgB,aAAa,EAAE;QACtBhB,OAAO,CAAC,IAAI,CAACgB,aAAa,CAAC;QAC3B;;MAEF9B,SAAS,CAAC+B,MAAM,CAAC;QAAEC,OAAO,EAAE5B;MAAU,CAAE,CAAC,CAAC6B,IAAI,CAACC,EAAE,IAAG;QAClD,IAAI,CAACJ,aAAa,GAAGI,EAAE;QACvBpB,OAAO,CAACoB,EAAE,CAAC;MACb,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEO,MAAMvB,GAAGA,CAACC,GAAW;IAC1B,MAAMsB,EAAE,GAAG,MAAM,IAAI,CAACL,GAAG;IACzB,OAAO,MAAMK,EAAE,CAACvB,GAAG,CAASC,GAAG,CAAC;IAChC;EACF;EAEO,MAAMK,GAAGA,CAACL,GAAW,EAAEM,KAAa;IACzC,MAAMgB,EAAE,GAAG,MAAM,IAAI,CAACL,GAAG;IACzB,MAAMK,EAAE,CAACjB,GAAG,CAACL,GAAG,EAAEM,KAAK,CAAC;EAC1B;EAEO,MAAME,MAAMA,CAACR,GAAW;IAC7B,MAAMsB,EAAE,GAAG,MAAM,IAAI,CAACL,GAAG;IACzB,MAAMK,EAAE,CAACd,MAAM,CAACR,GAAG,CAAC;EACtB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}